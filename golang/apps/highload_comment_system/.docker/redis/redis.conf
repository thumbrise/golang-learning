# Redis configuration file for persistence

# Enable RDB snapshots
save 900 1
save 300 10
save 60 10000

# RDB file name
dbfilename dump.rdb

# Directory where RDB and AOF files will be stored
dir /data

# Enable AOF (Append Only File) for better durability
appendonly yes
appendfilename "appendonly.aof"

# AOF fsync policy
# everysec: fsync every second (good compromise between performance and durability)
appendfsync everysec

# Disable RDB when AOF is enabled (optional, but recommended for better performance)
# save ""

# AOF rewrite configuration
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# Handle corrupted AOF files
aof-load-truncated yes

# Memory management
maxmemory-policy allkeys-lru

# Logging
loglevel notice
logfile ""

# Network
bind 0.0.0.0
port 6379
timeout 0
tcp-keepalive 300

# Security (optional - uncomment if needed)
# TODO: ensubst
#requirepass ${REDIS_PASSWORD}
